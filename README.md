# Data-management-Engineering

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ–∫–µ–∞–Ω–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö CalCOFI —Å –ø–æ–º–æ—â—å—é ETL-–ø–∞–π–ø–ª–∞–π–Ω–∞.

## –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –Ω–∞—É—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –î–∞—Ç–∞—Å–µ—Ç CalCOFI —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–∫–µ–∞–Ω–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∏ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è, —Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Å 1949 –≥–æ–¥–∞ —É –ø–æ–±–µ—Ä–µ–∂—å—è –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏–∏ ‚Äî —ç—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –¥–ª–∏–Ω–Ω—ã—Ö –∏ –ø–æ–ª–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–∏–π –¥–∞–Ω–Ω—ã—Ö –æ –º–æ—Ä—Å–∫–æ–π —Å—Ä–µ–¥–µ –≤ –º–∏—Ä–µ.

## –ó–∞—á–µ–º –Ω—É–∂–µ–Ω —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ Data Engineering: –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–æ –∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–µ–∫—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∏–∑—É—á–∞—é—â–∏—Ö –∂–µ–ª–∞—é—â–∏—Ö –ø–æ–Ω—è—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è ETL-–ø–∞–π–ø–ª–∞–π–Ω–æ–≤ –∏ –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –ø–æ –¥–∞–Ω–Ω—ã–º, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç —É–≤–∏–¥–µ—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º.


## –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç—ã

–°—Å—ã–ª–∫–∞ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç—ã: [–ü–∞–ø–∫–∞ –Ω–∞ Google Drive](https://drive.google.com/drive/folders/1GvA6M1ma6kzHevxSzJbiYUt6M8fEsJ1H?usp=sharing) 

–ò—Å—Ö–æ–¥–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞—Ç–∞—Å–µ—Ç–∞: [CalCOFI –Ω–∞ Kaggle](https://www.kaggle.com/datasets/sohier/calcofi?utm_source=chatgpt.com&select=cast.csv)

## –°—Å—ã–ª–∫–∞ –Ω–∞ EDA –Ω–æ—É—Ç–±—É–∫

üîó [–û—Ç–∫—Ä—ã—Ç—å EDA.ipynb –≤ nbviewer](https://nbviewer.org/github/yarazaytseva-lgtm/Project/blob/main/notebooks/EDA.ipynb)
 > –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ 

## ETL –ø–∞–∫–µ—Ç
```
etl/
	extract.py     # —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ CSV –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ data/raw
	transform.py   # –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –∏ –ø—Ä–æ—á–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
	validate.py    # –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
	load.py        # —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã–≥—Ä—É–∑–∫–∞ –≤ –ë–î
	main.py        # CLI-–æ–±—ë—Ä—Ç–∫–∞, —Å–≤—è–∑—ã–≤–∞—é—â–∞—è –≤—Å–µ —à–∞–≥–∏
data/
	raw/           # —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å—ã—Ä—ã–µ –≤—ã–≥—Ä—É–∑–∫–∏
	processed/     # –∏—Ç–æ–≥–æ–≤—ã–µ clean.csv –∏ clean.parquet
```
> –ü–∞–ø–∫–∞ `archive/` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —É—á–µ–±–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è, –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É ETL-–ø–∞–π–ø–ª–∞–π–Ω—É



## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

### 1. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```
python -m venv .venv
```

### 2. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```
.\.venv\Scripts\activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```
pip install -r requirements.txt
```

### 4. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–±–æ–ª–æ—á–∫–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL:
```
POSTGRES_URL=<host>
POSTGRES_PORT=<port>
POSTGRES_USER=<user>
POSTGRES_PASSWORD=<password>
POSTGRES_DB=<database>
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å ETL-pipeline
```
python -m etl.main <GOOGLE_DRIVE_FILE_ID> [--table-name my_table] [--limit 100] [--skip-db]
```
- –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç `GOOGLE_DRIVE_FILE_ID` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä CSV –≤ Google Drive;
- `--table-name` ‚Äî –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –≤ PostgreSQL (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `zaytseva`);
- `--limit` ‚Äî –º–∞–∫—Å–∏–º—É–º —Å—Ç—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–≥—Ä—É–∂–µ–Ω—ã –≤ –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `100`);
- `--skip-db` ‚Äî –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —ç—Ç–∞–ø –∑–∞–ø–∏—Å–∏ –≤ –ë–î –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã –≤ `data/processed`.

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –ë–î:
```
python -m etl.main 10eufblSIFd0USk8-6YX2O5NyMI1RlaP- --skip-db
```

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ —Å–∫—Ä–∏–ø—Ç–∞

**–í—ã–≤–æ–¥**:<img width="1113" height="511" alt="image" src="https://github.com/user-attachments/assets/54853796-a311-4344-a7dc-8fe9b9458fee" />
